gcc-9.3.0 loaded successful
cuda-12.1 loaded successful
============================================================================================================
Arguments =
	approach: ILFTF
	batch_size: 128
	clipping: 1.0
	collapse_alpha: 0.0
	datasets: ['domainnet']
	drift_loss_threshold: 1.0
	eval_on_train: False
	exp_name: exp_1_0415-1
	extra_aug: 
	fix_bn: False
	gpu: 0
	gridsearch_tasks: -1
	inc_sub_rate: 0.9
	keep_existing_head: False
	last_layer_analysis: False
	log: ['disk']
	lr: 0.05
	lr_factor: 3
	lr_min: 0.0001
	lr_patience: 5
	momentum: 0.9
	multi_softmax: False
	nc_first_task: 5
	nepochs: 200
	network: resnet18
	no_cudnn_deterministic: False
	num_experts: 5
	num_ini_classes: 90
	num_ini_tasks: 18
	num_tasks: 36
	num_workers: 4
	pin_memory: False
	pretrained: False
	random_seed: 0
	results_path: ../results
	save_models: False
	seed: 0
	small_data_rate: 0.1
	stop_at_task: 0
	use_test_as_val: True
	use_valid_only: False
	warmup_lr_factor: 1.0
	warmup_nepochs: 0
	weight_decay: 0.001
============================================================================================================
/home/bingxing2/home/scx7aum/.conda/envs/pytorch/lib/python3.11/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/bingxing2/home/scx7aum/.conda/envs/pytorch/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
Approach arguments =
	alpha: 0.99
	compensate_drifts: False
	ftepochs: 100
	ftwd: 0
	gmms: 1
	initialization_strategy: first
	max_experts: 5
	shared: 0
	tau: 3.0
	use_multivariate: True
	use_nmc: False
============================================================================================================
[(0, 5), (1, 5), (2, 5), (3, 5), (4, 5), (5, 5), (6, 5), (7, 5), (8, 5), (9, 5), (10, 5), (11, 5), (12, 5), (13, 5), (14, 5), (15, 5), (16, 5), (17, 5), (18, 5), (19, 5), (20, 5), (21, 5), (22, 5), (23, 5), (24, 5), (25, 5), (26, 5), (27, 5), (28, 5), (29, 5), (30, 5), (31, 5), (32, 5), (33, 5), (34, 5), (35, 5)]
************************************************************************************************************
Task  0
************************************************************************************************************
Training backbone on task 0:
The expert has 11,215,194 trainable parameters
The expert has 0 shared parameters

************************************************************************************************************
Task  1
************************************************************************************************************
Training backbone on task 1:
The expert has 11,215,194 trainable parameters
The expert has 0 shared parameters

************************************************************************************************************
Task  2
************************************************************************************************************
Training backbone on task 2:
The expert has 11,215,194 trainable parameters
The expert has 0 shared parameters

************************************************************************************************************
Task  3
************************************************************************************************************
Training backbone on task 3:
The expert has 11,215,194 trainable parameters
The expert has 0 shared parameters

************************************************************************************************************
Task  4
************************************************************************************************************
Training backbone on task 4:
The expert has 11,215,194 trainable parameters
The expert has 0 shared parameters

************************************************************************************************************
Task  5
************************************************************************************************************
Window model number is 0
root_KL: tensor([284.3750,  85.8658, 141.3827, 100.5055, 108.4090], device='cuda:0')
expert_KL: tensor([329.8811, 167.9791, 291.0590, 183.6187, 170.7957], device='cuda:0')
Finetuning backbone 0 on task 18:
Finetuning other backbones 1 on task 18:
Finetuning other backbones 2 on task 18:
Finetuning other backbones 3 on task 18:
Finetuning other backbones 4 on task 18:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task  6
************************************************************************************************************
Window model number is 0
root_KL: tensor([25.8013, 24.4463, 25.5740, 25.5293, 26.6268], device='cuda:0')
expert_KL: tensor([44.9780, 39.7170, 46.5619, 46.5630, 46.6300], device='cuda:0')
Finetuning backbone 4 on task 19:
Finetuning other backbones 0 on task 19:
Finetuning other backbones 1 on task 19:
Finetuning other backbones 2 on task 19:
Finetuning other backbones 3 on task 19:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task  7
************************************************************************************************************
Window model number is 0
root_KL: tensor([  25.4610, 1281.1621,   24.6850, 1311.2607, 1131.8191],
       device='cuda:0')
expert_KL: tensor([  43.1450, 9261.5674,   40.2838,   33.8024,   36.8829],
       device='cuda:0')
Finetuning backbone 1 on task 20:
Finetuning other backbones 0 on task 20:
Finetuning other backbones 2 on task 20:
Finetuning other backbones 3 on task 20:
Finetuning other backbones 4 on task 20:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task  8
************************************************************************************************************
Window model number is 0
root_KL: tensor([20.8725, 17.4689, 19.3785, 17.0217, 18.3575], device='cuda:0')
expert_KL: tensor([75.8663, 63.7247, 70.2404, 71.4394, 72.1536], device='cuda:0')
Finetuning backbone 0 on task 21:
Finetuning other backbones 1 on task 21:
Finetuning other backbones 2 on task 21:
Finetuning other backbones 3 on task 21:
Finetuning other backbones 4 on task 21:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task  9
************************************************************************************************************
Window model number is 0
root_KL: tensor([83.0461, 38.3900, 69.9393, 36.5191, 43.2562], device='cuda:0')
expert_KL: tensor([201.0333, 115.8109, 144.7247, 124.7415, 110.4989], device='cuda:0')
Finetuning backbone 0 on task 22:
Finetuning other backbones 1 on task 22:
Finetuning other backbones 2 on task 22:
Finetuning other backbones 3 on task 22:
Finetuning other backbones 4 on task 22:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 10
************************************************************************************************************
Window model number is 0
root_KL: tensor([255.0131,  74.1770, 111.0243,  72.4119,  79.5295], device='cuda:0')
expert_KL: tensor([331.1663, 112.1872, 143.9509,  92.6467, 125.1674], device='cuda:0')
Finetuning backbone 0 on task 23:
Finetuning other backbones 1 on task 23:
Finetuning other backbones 2 on task 23:
Finetuning other backbones 3 on task 23:
Finetuning other backbones 4 on task 23:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 11
************************************************************************************************************
Window model number is 0
root_KL: tensor([300.6538, 226.7663, 438.0306, 248.5972, 261.9595], device='cuda:0')
expert_KL: tensor([1798.2306,  283.2489,  411.2359,  272.9076,  471.3572],
       device='cuda:0')
Finetuning backbone 0 on task 24:
Finetuning other backbones 1 on task 24:
Finetuning other backbones 2 on task 24:
Finetuning other backbones 3 on task 24:
Finetuning other backbones 4 on task 24:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 12
************************************************************************************************************
Window model number is 0
root_KL: tensor([ 125.4653,   50.0839, 1019.6210,   54.6688,   61.5265],
       device='cuda:0')
expert_KL: tensor([  216.4203,    81.3238,   152.9065, 34890.7227,    72.5141],
       device='cuda:0')
Finetuning backbone 3 on task 25:
Finetuning other backbones 0 on task 25:
Finetuning other backbones 1 on task 25:
Finetuning other backbones 2 on task 25:
Finetuning other backbones 4 on task 25:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 13
************************************************************************************************************
Window model number is 0
root_KL: tensor([455.5302,  80.6492, 154.2428,  70.9049,  89.7959], device='cuda:0')
expert_KL: tensor([462.2254,  74.4019,  93.2049,  78.1276,  75.1258], device='cuda:0')
Finetuning backbone 0 on task 26:
Finetuning other backbones 1 on task 26:
Finetuning other backbones 2 on task 26:
Finetuning other backbones 3 on task 26:
Finetuning other backbones 4 on task 26:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 14
************************************************************************************************************
Window model number is 0
root_KL: tensor([16.4368, 14.2464, 15.4504, 13.7766, 14.7449], device='cuda:0')
expert_KL: tensor([51.4496, 40.1382, 40.1926, 44.0615, 37.8307], device='cuda:0')
Finetuning backbone 0 on task 27:
Finetuning other backbones 1 on task 27:
Finetuning other backbones 2 on task 27:
Finetuning other backbones 3 on task 27:
Finetuning other backbones 4 on task 27:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 15
************************************************************************************************************
Window model number is 0
root_KL: tensor([12.5062, 10.1088, 10.4736, 10.2604, 13.2709], device='cuda:0')
expert_KL: tensor([61.5516, 54.9212, 44.0525, 47.0169, 49.3433], device='cuda:0')
Finetuning backbone 0 on task 28:
Finetuning other backbones 1 on task 28:
Finetuning other backbones 2 on task 28:
Finetuning other backbones 3 on task 28:
Finetuning other backbones 4 on task 28:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 16
************************************************************************************************************
Window model number is 0
root_KL: tensor([72.7812, 36.9411, 70.7841, 36.2905, 40.5658], device='cuda:0')
expert_KL: tensor([  148.7244,    93.0669,   102.9611,    86.1171, 35584.9453],
       device='cuda:0')
Finetuning backbone 4 on task 29:
Finetuning other backbones 0 on task 29:
Finetuning other backbones 1 on task 29:
Finetuning other backbones 2 on task 29:
Finetuning other backbones 3 on task 29:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 17
************************************************************************************************************
Window model number is 0
root_KL: tensor([145.7816,  56.7794,  80.0110,  60.7296,  62.5251], device='cuda:0')
expert_KL: tensor([319.3717, 101.0511, 201.0474, 100.4651,  88.6276], device='cuda:0')
Finetuning backbone 0 on task 30:
Finetuning other backbones 1 on task 30:
Finetuning other backbones 2 on task 30:
Finetuning other backbones 3 on task 30:
Finetuning other backbones 4 on task 30:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 18
************************************************************************************************************
Window model number is 0
root_KL: tensor([159.4493,  98.2143, 166.8387,  94.8324, 110.7367], device='cuda:0')
expert_KL: tensor([429.5617,  82.6196, 114.7664,  86.2295,  96.6034], device='cuda:0')
Finetuning backbone 0 on task 31:
Finetuning other backbones 1 on task 31:
Finetuning other backbones 2 on task 31:
Finetuning other backbones 3 on task 31:
Finetuning other backbones 4 on task 31:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 19
************************************************************************************************************
Window model number is 0
root_KL: tensor([1485.7252,  402.7152,  535.6921, 2947.6865,  402.4438],
       device='cuda:0')
expert_KL: tensor([972.5593, 629.1580, 821.8011, 629.2271, 761.6435], device='cuda:0')
Finetuning backbone 0 on task 32:
Finetuning other backbones 1 on task 32:
Finetuning other backbones 2 on task 32:
Finetuning other backbones 3 on task 32:
Finetuning other backbones 4 on task 32:
Creat a new bench model
Finetuning benchmodel 0 on task 32:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 20
************************************************************************************************************
Window model number is 1
root_KL: tensor([17.5811, 14.3043, 16.2794, 14.3957, 15.1175], device='cuda:0')
expert_KL: tensor([58.3320, 43.8958, 44.7906, 48.7302, 39.9358], device='cuda:0')
bench_KL: tensor([59.3590,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000], device='cuda:0')
Finetuning backbone 0 on task 33:
Finetuning other backbones 1 on task 33:
Finetuning other backbones 2 on task 33:
Finetuning other backbones 3 on task 33:
Finetuning other backbones 4 on task 33:
------------------------------------------------------------------------------------------------------------
************************************************************************************************************
Task 21
************************************************************************************************************
Window model number is 1
Traceback (most recent call last):
  File "/home/bingxing2/home/scx7aum/NEW-SEED/SEED-main/src/main_incremental.py", line 363, in <module>
    main()
  File "/home/bingxing2/home/scx7aum/NEW-SEED/SEED-main/src/main_incremental.py", line 315, in main
    appr.train(tt, trn_loader, val_loader,val_loader[t],subdata_trn_loader,data_inc_trn_loader)
  File "/home/bingxing2/home/scx7aum/NEW-SEED/SEED-main/src/approach/incremental_learning.py", line 69, in train
    self.train_loop(t, trn_loader, val_loader,old_val_loader,subdata_trn_load,data_inc_trn_loader)#不会进本文件的train_loop了，而是会进实验对应选择的算法内的train_loop，比如会进seed内的train_loop()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bingxing2/home/scx7aum/NEW-SEED/SEED-main/src/approach/ILFTF.py", line 142, in train_loop
    root_to_finetune, expert_to_finetune, bench_to_finetune, from_root_trunk_win = self._choose_model_to_finetune(t, trn_loader[t], val_loader[t])############
                                                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bingxing2/home/scx7aum/.conda/envs/pytorch/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bingxing2/home/scx7aum/NEW-SEED/SEED-main/src/approach/ILFTF.py", line 238, in _choose_model_to_finetune
    self.create_distributions(t, trn_loader, val_loader, from_root_trunk_win)
  File "/home/bingxing2/home/scx7aum/.conda/envs/pytorch/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bingxing2/home/scx7aum/NEW-SEED/SEED-main/src/approach/ILFTF.py", line 527, in create_distributions
    self._create_distributions(t, trn_loader, transforms,classes,2)
  File "/home/bingxing2/home/scx7aum/.conda/envs/pytorch/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bingxing2/home/scx7aum/NEW-SEED/SEED-main/src/approach/ILFTF.py", line 477, in _create_distributions
    features = model(images)
               ^^^^^^^^^^^^^
TypeError: 'list' object is not callable
